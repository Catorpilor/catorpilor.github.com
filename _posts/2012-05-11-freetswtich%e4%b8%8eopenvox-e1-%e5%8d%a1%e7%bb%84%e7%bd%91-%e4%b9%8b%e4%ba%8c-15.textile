---
layout: post
title: freetswtich与Openvox  E1 卡组网 之二
tags:
- freeswitch 
- freetdm 
- dahdi 
- libpri
---
p. 前几天的环境搭建是Centos5.2 freeswitch libpri zaptel ，其中在freeswitch中加载了openzap模块来控制e1板卡，但是结果不太理想。做外呼测试时号码送不出去显示TON unknown google也得不好好的解决方法。

p. freeswitch wiki里面也提到了openzap已经被freetdm所代替，openzap的开发也停止了。今天就加载了freetdm模块，在加载之前 openvox d130的驱动也做了变化，采用了<a href="http://wiki.freeswitch.org/wiki/FreeTDM#DAHDI_mode">freetdm</a>所配套的<a href="http://downloads.openvox.cn/pub/drivers/dahdi-linux-complete/openvox_dahdi-linux-complete-current.tar.gz">dahdi</a>驱动 参考了<a href="http://wiki.openvox.cn/index.php/OpenVox_D130P_Dahdi_en">asterisk dahdi的安装方法</a>

p. 安装成功后开始配置e1卡，按照wiki中所说的，在/usr/local/freeswitch/conf目录下的freetdm.conf文件其实是/etc/dahdi/system.conf的镜像，按照system.conf中所显示的内容去配置freetdm.conf

<a href="http://zerothero.files.wordpress.com/2012/05/dahdi.png"><img class="size-full wp-image" src="http://zerothero.files.wordpress.com/2012/05/dahdi.png?w=487" alt="Image" /></a>

<a href="http://zerothero.files.wordpress.com/2012/05/freetdm.png"><img class="size-full wp-image" src="http://zerothero.files.wordpress.com/2012/05/freetdm.png?w=487" alt="Image" /></a>

p. 接下来就是/usr/local/freeswitch/conf/autoload_configs/目录下面的freetdm.conf.xml配置

p. 当前的测试环境是通过e1线 与另外一个e1组网，所以在这个配置文件里面把node的值改为network<strong>（cpe与network相当于master-slave）</strong>

p. 配置完毕后启动freeswitch 运行ftdm list显示<a href="http://zerothero.files.wordpress.com/2012/05/ftdm.png"><img class="size-full wp-image" src="http://zerothero.files.wordpress.com/2012/05/ftdm.png?w=487" alt="Image" /></a>

p. 添加了一个拨号方案后

p. 在作cpe的CM端拨打测试 OK！
